{"ast":null,"code":"var _jsxFileName = \"/Users/rhead/Coding/campswim/dashboard/dashboard-ncompass/src/pages/users/users.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useLocation, Redirect } from 'react-router-dom';\nimport User from './user';\nimport UserClass from '../../hooks/get-user';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Users = props => {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [loggedInUser, setLoggedInUser] = useState(localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null);\n  const [error, setError] = useState('');\n  const [rerender, setRerender] = useState(false);\n  const currentTab = useRef(null);\n  const params = useLocation();\n  const state = params === null || params === void 0 ? void 0 : params.state;\n\n  // Set the current tab.\n  const handleClick = callerId => {\n    setRerender(!rerender);\n    currentTab.current = callerId;\n  };\n\n  // Refresh the users page.\n  const recall = path => {\n    if (path) setIsLoaded(false);\n    setRerender(!rerender);\n  };\n\n  // Get users from the db.\n  useEffect(() => {\n    let mounted = true;\n    const user = new UserClass();\n    if (mounted) {\n      user.getAllUsers().then(res => {\n        console.log({\n          res\n        });\n        if (res.data) {\n          if (res.data.users) setUsers(Array.isArray(res.data.users) ? res.data.users : [res.data.users]);\n          setIsLoaded(true);\n          setError(null);\n        } else if (res.name) {\n          setError({\n            code: res.name,\n            message: res.message\n          });\n          setIsLoaded(true);\n        }\n      }, err => {\n        console.error({\n          err\n        });\n        setError(err);\n        setIsLoaded(false);\n      });\n    }\n    return () => mounted = false;\n  }, [rerender]);\n\n  // Set the user from local storage.\n  useEffect(() => {\n    let mounted = true;\n    if (mounted) {\n      setLoggedInUser(localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null);\n    }\n    return () => mounted = false;\n  }, []);\n  return !loggedInUser ?\n  /*#__PURE__*/\n  // The user is not logged in, so return her to the log-in page.\n  _jsxDEV(Redirect, {\n    to: {\n      pathname: '/login',\n      state: {\n        // id,\n        action: 'Sign In',\n        message: 'Please sign in.'\n      }\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this) : loggedInUser.restrictions.pages === 'None' || !loggedInUser.restrictions.pages.includes('Users') ? !props.clearId ? props.role !== 'User' ? /*#__PURE__*/_jsxDEV(User, {\n    users: users,\n    isLoaded: isLoaded,\n    error: error,\n    handleClick: handleClick,\n    activeTab: currentTab.current,\n    recall: recall,\n    role: props.role,\n    action: state === null || state === void 0 ? void 0 : state.action,\n    id: state === null || state === void 0 ? void 0 : state.id,\n    message: state === null || state === void 0 ? void 0 : state.message,\n    liftData: props.liftData,\n    liftUser: props.liftUser\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 11\n  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"role-denied\",\n    children: [\"Your profile's assigned role of \\\"\", props.role, \"\\\" does not allow you to access this page.\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 11\n  }, this) : null : /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"role-denied\",\n    children: [\"Your profile's assigned role of \\\"\", loggedInUser.role, \"\\\" does not allow you to access this page.\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 7\n  }, this);\n};\n_s(Users, \"taeYFSs518h3Qq2oLXSdoJRpzrQ=\", false, function () {\n  return [useLocation];\n});\n_c = Users;\nexport default Users;\nvar _c;\n$RefreshReg$(_c, \"Users\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useLocation","Redirect","User","UserClass","jsxDEV","_jsxDEV","Users","props","_s","users","setUsers","isLoaded","setIsLoaded","loggedInUser","setLoggedInUser","localStorage","getItem","JSON","parse","error","setError","rerender","setRerender","currentTab","params","state","handleClick","callerId","current","recall","path","mounted","user","getAllUsers","then","res","console","log","data","Array","isArray","name","code","message","err","to","pathname","action","fileName","_jsxFileName","lineNumber","columnNumber","restrictions","pages","includes","clearId","role","activeTab","id","liftData","liftUser","className","children","_c","$RefreshReg$"],"sources":["/Users/rhead/Coding/campswim/dashboard/dashboard-ncompass/src/pages/users/users.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useLocation, Redirect } from 'react-router-dom';\nimport User from './user';\nimport UserClass from '../../hooks/get-user';\n\nconst Users = (props) => {\n  const [users, setUsers] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [loggedInUser, setLoggedInUser] = useState(localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null);\n  const [error, setError] = useState('');\n  const [rerender, setRerender] = useState(false);\n  const currentTab = useRef(null);\n  const params = useLocation();  \n  const state = params?.state;\n\n  // Set the current tab.\n  const handleClick = (callerId) => {\n    setRerender(!rerender);\n    currentTab.current = callerId;\n  }\n\n  // Refresh the users page.\n  const recall = path => {\n  if (path) setIsLoaded(false);\n   setRerender(!rerender);\n  }\n\n  // Get users from the db.\n  useEffect(() => {\n    let mounted = true;\n    const user = new UserClass();\n    \n    if (mounted) {\n      user.getAllUsers().then(\n        res => {\n\n          console.log({res});\n          \n          if (res.data) {\n            if (res.data.users) setUsers(Array.isArray(res.data.users) ? res.data.users : [res.data.users]);\n            setIsLoaded(true);\n            setError(null);\n          } else if (res.name) {\n            setError({code: res.name, message: res.message});\n            setIsLoaded(true);\n          }\n        },\n        err => {\n          console.error({err});\n          setError(err);\n          setIsLoaded(false);\n        }\n      );\n    }\n    \n    return () => mounted = false;\n  }, [rerender]);\n  \n  // Set the user from local storage.\n  useEffect(() => {\n    let mounted = true;\n    if (mounted) {\n      setLoggedInUser(localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null);\n    }\n    return () => mounted = false;\n  }, []);\n  \n  return !loggedInUser ? \n  ( // The user is not logged in, so return her to the log-in page.\n    <Redirect to=\n      {\n        {\n          pathname: '/login',\n          state: {\n            // id,\n            action: 'Sign In',\n            message: 'Please sign in.'\n          },\n        }\n      }\n    />\n  ) \n  :\n  (\n    loggedInUser.restrictions.pages === 'None' || !loggedInUser.restrictions.pages.includes('Users') ?\n    (\n      !props.clearId ?\n      (\n        props.role !== 'User' ?\n          <User \n            users={users} \n            isLoaded={isLoaded} \n            error={error} \n            handleClick={handleClick} \n            activeTab={currentTab.current} \n            recall={recall} \n            role={props.role} \n            action={state?.action} \n            id={state?.id} \n            message={state?.message} \n            liftData={props.liftData} \n            liftUser={props.liftUser} \n          />\n        : <div className=\"role-denied\">Your profile's assigned role of \"{props.role}\" does not allow you to access this page.</div>\n      )\n      : \n      (\n        null\n      )\n    )\n    :\n    (\n      <div className=\"role-denied\">Your profile's assigned role of \"{loggedInUser.role}\" does not allow you to access this page.</div>\n    )\n  )\n};\n\nexport default Users;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}